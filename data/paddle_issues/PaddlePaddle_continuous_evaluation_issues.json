[
    {
        "repo": "PaddlePaddle/continuous_evaluation",
        "number": 25,
        "title": "Some issues about deploying a stable CE ",
        "body": "1. the permission of PaddlePaddle/latest_ce_tasks\r\n2. the stability of CE tasks, std/mean need a threshold to clean up the existing unstable tasks, furthermore, need a mechanism to avoid adding unstable tasks.\r\n3. AWS instances related\r\n4. fast test\r\n5. why merging tasks to CE framework is not a good idea.",
        "state": "open",
        "user": "Superjomn",
        "closed_by": null,
        "created_at": "2018-04-24T01:57:47+00:00",
        "updated_at": "2018-04-24T01:57:47+00:00",
        "closed_at": null,
        "comments_count": [],
        "labels": []
    },
    {
        "repo": "PaddlePaddle/continuous_evaluation",
        "number": 27,
        "title": "CE 用 travis-ci 持续集成",
        "body": "",
        "state": "open",
        "user": "Superjomn",
        "closed_by": null,
        "created_at": "2018-04-26T08:54:05+00:00",
        "updated_at": "2018-04-26T08:54:05+00:00",
        "closed_at": null,
        "comments_count": [],
        "labels": []
    },
    {
        "repo": "PaddlePaddle/continuous_evaluation",
        "number": 6,
        "title": "init the database framework to memorize the details",
        "body": "",
        "state": "open",
        "user": "Superjomn",
        "closed_by": null,
        "created_at": "2018-03-21T07:22:12+00:00",
        "updated_at": "2018-03-21T07:22:35+00:00",
        "closed_at": null,
        "comments_count": [],
        "labels": [
            "enhancement"
        ]
    },
    {
        "repo": "PaddlePaddle/continuous_evaluation",
        "number": 5,
        "title": "Need an exclusive server to deploy CE.",
        "body": "",
        "state": "open",
        "user": "Superjomn",
        "closed_by": null,
        "created_at": "2018-03-21T07:12:58+00:00",
        "updated_at": "2018-03-21T07:18:39+00:00",
        "closed_at": null,
        "comments_count": [],
        "labels": [
            "enhancement"
        ]
    },
    {
        "repo": "PaddlePaddle/continuous_evaluation",
        "number": 3,
        "title": "build alpha",
        "body": "Build a demo with following features:\r\n- a universal framework for any evaluation\r\n- supporting baseline update automatically when encountered a better result\r\n- baseline version persistence\r\n\r\n# TODOs \r\n- [x] evaluation framework\r\n- [x] web page\r\n- [ ] email alert\r\n- [ ] eight models for test\r\n  - [x] resnt30\r\n- [ ] start a stable service and test continually.",
        "state": "closed",
        "user": "Superjomn",
        "closed_by": "Superjomn",
        "created_at": "2018-03-19T06:35:20+00:00",
        "updated_at": "2018-03-19T09:35:18+00:00",
        "closed_at": "2018-03-19T09:35:18+00:00",
        "comments_count": [],
        "labels": []
    },
    {
        "repo": "PaddlePaddle/continuous_evaluation",
        "number": 26,
        "title": "多卡并行加速task",
        "body": "",
        "state": "open",
        "user": "Superjomn",
        "closed_by": null,
        "created_at": "2018-04-26T08:51:28+00:00",
        "updated_at": "2018-08-13T23:32:09+00:00",
        "closed_at": null,
        "comments_count": [],
        "labels": []
    },
    {
        "repo": "PaddlePaddle/continuous_evaluation",
        "number": 28,
        "title": "自动稳定性验证",
        "body": "监测model repo的改动， 自动触发变更的model的稳定运行， 通过多次运行结果判断model的变更是否符合预期。 \r\nteamcity 地址：\r\nhttp://18.222.34.7:8080/viewType.html?buildTypeId=Paddle_CeTaskEvaluation",
        "state": "closed",
        "user": "Superjomn",
        "closed_by": "guochaorong",
        "created_at": "2018-04-26T09:24:25+00:00",
        "updated_at": "2018-05-24T02:37:20+00:00",
        "closed_at": "2018-05-10T08:02:44+00:00",
        "comments_count": [
            "guochaorong"
        ],
        "labels": []
    },
    {
        "repo": "PaddlePaddle/continuous_evaluation",
        "number": 8,
        "title": "evaluate resnet50 model",
        "body": "factor:\r\ntrain_cost\r\ntrain_speed\r\ntest_acc ",
        "state": "closed",
        "user": "kolinwei",
        "closed_by": "Superjomn",
        "created_at": "2018-03-22T11:13:53+00:00",
        "updated_at": "2018-04-12T07:59:26+00:00",
        "closed_at": "2018-04-12T07:59:26+00:00",
        "comments_count": [
            "Superjomn"
        ],
        "labels": []
    },
    {
        "repo": "PaddlePaddle/continuous_evaluation",
        "number": 17,
        "title": "A survey of using Google Sheets API v4",
        "body": "Because my most familiar language is Go, so I conducted my experiments using the Go client library.\r\n\r\n## Install Go \r\n\r\nIf you use Mac, you can install Go using [Homebrew](https://brew.sh/). Or, follow the [official installation guide](https://golang.org/doc/install).\r\n\r\n## Configure the IDE\r\n\r\nIf you use Emacs, please follow [Helin’s configuration](github.com/helinwang/go-emacs).\r\n\r\n## Create a Google Account\r\n\r\nTo access Google API, you need a [Gmail account](https://support.google.com/mail/answer/56256?hl=en).\r\n\r\n## Write a Google API Application\r\n\r\nBefore you can write an application program that access your Google data, you need to register the application so to get a token to identify it.  Then, you can write and run your application.  Please follow the [Google API tutorial](https://developers.google.com/sheets/api/quickstart/go) for both steps.\r\n\r\n## Google Sheets API v4\r\n\r\nThe most recent version of Sheets API is v4.\r\n\r\nThe Go binding is at https://github.com/google/google-api-go-client/blob/master/sheets/v4/sheets-gen.go. The source code is automatically generated from the [RESTful format of the API](https://developers.google.com/sheets/api/reference/rest/). I use the [GoDoc page](https://godoc.org/google.golang.org/api/sheets/v4) to understand important services:\r\n\r\n- Spreadsheets\r\n- Spreadsheets.DeveloperMetadata\r\n- Spreadsheets.Sheets\r\n- Spreadsheets.Values\r\n\r\n\r\n## Range\r\n\r\nFrom the quick start example program, you might noticed that we need to specify the range in a sheet to read from or to write to.  There is no official documentation about it, but we have a version from trial-n-err: https://productforums.google.com/forum/#!topic/docs/8w9TzS7JEQI.\r\n\r\n",
        "state": "open",
        "user": "wangkuiyi",
        "closed_by": null,
        "created_at": "2018-04-02T02:41:52+00:00",
        "updated_at": "2018-04-02T03:00:42+00:00",
        "closed_at": null,
        "comments_count": [
            "wangkuiyi"
        ],
        "labels": []
    },
    {
        "repo": "PaddlePaddle/continuous_evaluation",
        "number": 37,
        "title": "web monitor 添加指标单位",
        "body": "",
        "state": "open",
        "user": "Superjomn",
        "closed_by": null,
        "created_at": "2018-05-09T09:21:07+00:00",
        "updated_at": "2018-08-13T23:31:33+00:00",
        "closed_at": null,
        "comments_count": [],
        "labels": []
    },
    {
        "repo": "PaddlePaddle/continuous_evaluation",
        "number": 39,
        "title": "趋势图",
        "body": "",
        "state": "open",
        "user": "guochaorong",
        "closed_by": null,
        "created_at": "2018-05-11T02:55:19+00:00",
        "updated_at": "2018-05-11T02:59:39+00:00",
        "closed_at": null,
        "comments_count": [],
        "labels": []
    },
    {
        "repo": "PaddlePaddle/continuous_evaluation",
        "number": 43,
        "title": "CE模型对齐",
        "body": "对CE中模型进行梳理（见后面所附表），  \r\n模型如下：\r\nimage_classification  vgg16 mnist object_detection resnet30 resnet50 \r\nseq2seq sequence_tagging_for_ner text_classification transformer  language_model lstm\r\n\r\n需要考虑增加和对齐的内容如下：\r\n\r\n1. 模型都改成多卡跑（4卡）（后续，我把指定卡放到外边，单卡、多卡均跑一遍）\r\n\r\n2. 每个模型的评价指标需要包含这4个数据（acc/ppl，cost ，mem  和 duration）\r\n\r\n3. 目前只监控了上述4个评价指标的diff，我观察到两种非预期情况，1 .跑得时间很短， acc 很低（0.1），2. 跑了很多轮， acc很低（0.1，模型自身有问题）。\r\n 暂时方案， 我们将轮数很低的加长（跑30min左右），将acc都统一调到0.5以上。\r\n（后续我加上acc基数阈值告警。）\r\n\r\n4. 数据集统一使用现成的（而不是每次都下载）， 放在默认的/root/.cache/paddle/dataset目录\r\n\r\n\r\n\r\n\r\n模型 | 数据集 | Pass  轮数， | 当前执行情况 | 评价指标 | 参数\r\n-- | -- | -- | -- | -- | --\r\nLstm   影评       Layers：words   DynamicRNN | paddle.dataset.imdb as imdb           http://ai.stanford.edu/%7Eamaas/data/sentiment/aclImdb_v1.tar.gz | 1轮 | Pass = 0, Iter = 49, Loss = 0.713064,   Accuracy = 0.593750           nvidia-smi --id=%s   --query-compute-apps=used_memory --format=csv -lms 1 > memory.txt | imdb_32_train_speed   imdb_32_gpu_memory | batch_size: 32 device: GPU   emb_dim: 512   gpu_id: 0   hidden_dim: 512   iterations: 50   skip_batch_num: 5\r\nobject_detection | dataset:   pascalvoc   和coco 数据集   指定在/data/目录， 但没有 | Pass轮数：2 | IOError:   [Errno 2] No such file or directory: '/data/pascalvoc/label_list'   需要在/data目录防止数据 | train_cost_kpi   train_speed_kpi | batch_size:   64   is_toy:   0   iterations:   120   learning_rate:   0.001   num_passes:   2   parallel:   True   use_gpu:   True\r\nResnet50 | Flowers   cifar           http://www.robots.ox.ac.uk/~vgg/   data/flowers/102/102flowers.tgz | Pass 轮数：29（不收敛） | Pass:2,   Loss:3.229035, Train Accuray:0.247656, Test Accuray:0.176471,    Handle   Images Duration: 63.949636 | cifar10_128_train_acc_kpi,   cifar10_128_train_speed_kpi,   cifar10_128_gpu_memory_kpi,   flowers_64_train_speed_kpi,   flowers_64_gpu_memory_kpi,       起了个线程取mem信息，   并没有评价acc等 | batch_size:   64   data_format:   NCHW   data_set:   flowers   device:   GPU   infer_only:   False   iterations:   80   model: resnet_imagenet   pass_num:   3   skip_batch_num:   5\r\nPass:29,   Loss:0.026319, Train Accuray:0.993359, Test Accuray:0.559400,    Handle Images Duration: 22.501337\r\nlanguage_model | /root/.cache/paddle/dataset/imikolov/   simple-examples.tgz |   | ppl:61.667   time_cost(s):18.544248 |   |  \r\nsequence_tagging_for_ner | 数据集   http://cs224d.stanford.edu/assignment2/   assignment2.zip | Pass轮数：   22轮 | download   data error!   增加目录data后ok   [TestSet] pass_id:2200 【pass num 每次增加100】pass_precision:[0.18181819] pass_recall:[0.125]   pass_f1_score:[0.14814815] | train_acc_kpi,    pass_duration_kpi, |  \r\ntext_classification | Imdb   http://ai.stanford.edu/%7Eamaas/data/sentiment/aclImdb_v1.tar.gz | Pass：14 | avg_acc:   0.999800, avg_cost: 0.002255 |   |  \r\nVgg16 | flowers/imagelabels.mat   http://www.robots.ox.ac.uk/~vgg/data/   flowers/102/imagelabels.mat | 1轮 | cifar10   Pass: 1,   Loss: 1.810090, Train Accuray: 0.234375 | cifar10_128_train_speed_kpi,    cifar10_128_gpu_memory_kpi,   flowers_32_train_speed_kpi,   flowers_32_gpu_memory_kpi,   起了个线程取mem信息，   并没有评价acc等 |  \r\nPass:   49, Loss: 3.561218, Train Accuray: 0.093750\r\n  |   |   |   |   |  \r\n\r\n\r\n\r\n",
        "state": "closed",
        "user": "guochaorong",
        "closed_by": "guochaorong",
        "created_at": "2018-05-14T05:52:37+00:00",
        "updated_at": "2018-05-14T06:10:14+00:00",
        "closed_at": "2018-05-14T06:10:14+00:00",
        "comments_count": [],
        "labels": []
    },
    {
        "repo": "PaddlePaddle/continuous_evaluation",
        "number": 41,
        "title": "CE模型中使用pass num参数控制轮数",
        "body": "目前 有些模型中pass num参数没有用到，",
        "state": "open",
        "user": "guochaorong",
        "closed_by": null,
        "created_at": "2018-05-11T07:00:21+00:00",
        "updated_at": "2018-05-11T07:02:06+00:00",
        "closed_at": null,
        "comments_count": [],
        "labels": []
    },
    {
        "repo": "PaddlePaddle/continuous_evaluation",
        "number": 42,
        "title": "dataset 使用缓存",
        "body": "模型的数据集一般是不更新的， 可以使用之前下载过的数据，不需要每次下载。\r\n\r\n目前的很多models 都新下载数据， 看 /root/.cache 下没有， 新下载数据。\r\n还有一部分是使用/data下的数据， 但/data 并没有放数据。\r\n\r\n将dataset 标准化， 统一放到/root/.cache 宿主机下。 ",
        "state": "closed",
        "user": "guochaorong",
        "closed_by": "guochaorong",
        "created_at": "2018-05-11T10:13:50+00:00",
        "updated_at": "2018-07-04T03:10:42+00:00",
        "closed_at": "2018-07-04T03:10:42+00:00",
        "comments_count": [],
        "labels": []
    },
    {
        "repo": "PaddlePaddle/continuous_evaluation",
        "number": 44,
        "title": "check 目前stable的模型阈值设定",
        "body": "确定稳定的模型，如下阈值确定设置合理：\r\n- diff ratio\r\n- update ratio\r\n- actived\r\n\r\n方便值班追踪 Paddle 代码质量",
        "state": "open",
        "user": "Superjomn",
        "closed_by": null,
        "created_at": "2018-05-14T06:02:57+00:00",
        "updated_at": "2018-05-14T06:26:37+00:00",
        "closed_at": null,
        "comments_count": [],
        "labels": []
    },
    {
        "repo": "PaddlePaddle/continuous_evaluation",
        "number": 53,
        "title": "CE模型PR监控",
        "body": "原来CE模型设置的merge监控，模型需要merge到CE模型库才能暴露问题。\r\n本周增加CE 模型repo PR的监控告警。这样能够保证模型在merge到CE模型库之前 是功能正确，并且阈值在范围内.\r\n\r\n栗子:\r\nhttps://github.com/Superjomn/paddle-ce-latest-kpis/pull/33\r\n效果如下：\r\n![image](https://user-images.githubusercontent.com/32069604/40461460-1f717b3a-5f3e-11e8-84a7-133030dd0de9.PNG)\r\n\r\n\r\n点击\"details\"\r\nhttp://18.222.34.7:8080/viewLog.html?buildId=450&buildTypeId=Paddle_CeTaskEvaluation",
        "state": "open",
        "user": "guochaorong",
        "closed_by": null,
        "created_at": "2018-05-24T02:34:17+00:00",
        "updated_at": "2018-05-24T02:37:47+00:00",
        "closed_at": null,
        "comments_count": [],
        "labels": []
    },
    {
        "repo": "PaddlePaddle/continuous_evaluation",
        "number": 45,
        "title": "CE模型对齐",
        "body": "CE模型添加多卡支持，待验证Model CE多卡加速比指标",
        "state": "open",
        "user": "guochaorong",
        "closed_by": null,
        "created_at": "2018-05-14T06:07:55+00:00",
        "updated_at": "2018-05-17T04:28:50+00:00",
        "closed_at": null,
        "comments_count": [
            "guochaorong"
        ],
        "labels": []
    },
    {
        "repo": "PaddlePaddle/continuous_evaluation",
        "number": 63,
        "title": "CE web 问题修复",
        "body": "1. commit details 和 compare页面不加cache。\r\n如果用户请求了一个commit detail页面后再请求另一个commit detail页面，因为缓存的存在，会导致用户看到的页面信息和实际对不上。 而且这个响应时间本来比较短，可以不加缓存\r\n![details](https://user-images.githubusercontent.com/32069604/40790975-e44db604-6528-11e8-9932-c0deb4cfa71c.JPG)\r\n\r\n\r\n2. compare 显示的commit id信息，目前没有顺序\r\n计划将新的commit 显示在上面，老commit在下面的顺序排列，方便选择\r\n\r\n\r\n3. 对于后来加的模型，以及后来模型新加的kpis， 需要判断是否两个commit都有相应的task或kpi，否则会key error\r\n\r\n![code](https://user-images.githubusercontent.com/32069604/40793051-02e2ad5e-652e-11e8-9d49-34d3e4be264d.JPG)\r\n\r\n\r\n例如，选择两个commit 比较，ce server报错：\r\n![error](https://user-images.githubusercontent.com/32069604/40791648-953e399c-652a-11e8-9b40-f088e5f9fe0d.PNG)\r\n\r\n",
        "state": "open",
        "user": "guochaorong",
        "closed_by": "guochaorong",
        "created_at": "2018-05-31T15:35:04+00:00",
        "updated_at": "2018-06-01T02:17:58+00:00",
        "closed_at": null,
        "comments_count": [],
        "labels": []
    },
    {
        "repo": "PaddlePaddle/continuous_evaluation",
        "number": 71,
        "title": "CE web正在跑的commit 显示doing状态",
        "body": "\r\n![222](https://user-images.githubusercontent.com/32069604/41449054-5973b564-7091-11e8-8f4c-adaa293d2f42.PNG)\r\n\r\n最上面那个任务， 点击进去经常发现只有几个tasks，\r\n将其显示doing状态或者在doing 的不显示在CE web上？\r\n\r\n避免用户以为我们只有这几个模型\r\n\r\n\r\n",
        "state": "open",
        "user": "guochaorong",
        "closed_by": null,
        "created_at": "2018-06-15T03:46:20+00:00",
        "updated_at": "2018-06-15T03:46:40+00:00",
        "closed_at": null,
        "comments_count": [],
        "labels": []
    },
    {
        "repo": "PaddlePaddle/continuous_evaluation",
        "number": 46,
        "title": "添加一个可用的 CPU 验证task",
        "body": "需要验证模型的 CPU 性能，精度，尽量调小阈值，达到可以检测代码库的效果",
        "state": "open",
        "user": "Superjomn",
        "closed_by": null,
        "created_at": "2018-05-14T06:21:49+00:00",
        "updated_at": "2018-05-17T03:09:24+00:00",
        "closed_at": null,
        "comments_count": [
            "guochaorong"
        ],
        "labels": []
    },
    {
        "repo": "PaddlePaddle/continuous_evaluation",
        "number": 67,
        "title": "celery异步分布式工具调研",
        "body": "http://www.celeryproject.org/\r\nteamcity上只支持3个免费agent。 如果将来需要测试若干种机型task， 需要加若干agent才能支持。\r\n调研了celery 工具\r\n\r\n### **流程**\r\nmaster监测到teamcity 上的queue 中有tasks，\r\n执行相应的调度\r\n```python\r\n@app.task\r\ndef V100():\r\n    #Run tasks on v100\r\n    return {\"task_kpis\":\"kpis_values\", \"task_type\": \"v100\"}\r\n\r\n@app.task\r\ndef P40():\r\n    #Run tasks on P40\r\n    return {\"task_kpis\":\"kpis_values\", \"task_type\": \"p40\"}\r\n\r\nif __name__ == \"__main__\":\r\n    if \"task name is startswith v100\":\r\n        re = V100.delay()\r\n    elif \"task name is startswith p40\":\r\n        re = P40.delay()\r\n    print(re.result)\r\n    print(re.get(timeout=2))\r\n    print(re.status)\r\n```\r\n每一个work机器上启动work 监控进程 \r\n比如v100 work上\r\n```python\r\n@app.task\r\ndef V100():\r\n    #Run tasks on v100\r\n    return {\"task_kpis\":\"kpis_values\", \"task_type\": \"v100\"}\r\n```\r\n```sh\r\ncelery -A download  worker -l info -c 5\r\n```\r\n\r\n当master执行时， v100 worker上就会收到消息并执行V100函数\r\n```sh\r\n[2018-06-13 18:45:00,533: INFO/MainProcess] Received task: download.V100[03a74fb0-df6a-4ec0-b9cc-bc8e4870194e]  \r\n[2018-06-13 18:45:00,541: INFO/ForkPoolWorker-3] Task download.V100[03a74fb0-df6a-4ec0-b9cc-bc8e4870194e] succeeded in 0.00594224780798s: {'task_kpis': 'kpis_values'}\r\n```\r\n\r\nmaster上可以拿到各个worker的返回\r\n```sh\r\n{u'task_type': u'v100', u'task_kpis': u'kpis_values'}\r\n```\r\n\r\n\r\n### **celery存在的问题**\r\n1. 多机时， 每个机器上都要有所有代码， master上并未执行真正逻辑, 依然需要注册该函数。\r\n文档中对于多机使用不清晰， \r\n\r\n2. 我们ce中所有步骤都在docker中执行， 采用celery，所有命令都得加上docker run XX， 并且可能会踩坑\r\n\r\n3. 这样其实破坏了teamcity 本来的queue 队列和pool池子的 异步调用功能。考虑到优先维护好v100 和 p40 两个场景下tasks功能完备性， 目前agent 数目并不是瓶颈。 \r\n\r\n和春伟讨论决定继续按照加agent 方式进行， 以后有需要再用工具流",
        "state": "open",
        "user": "guochaorong",
        "closed_by": null,
        "created_at": "2018-06-13T10:48:57+00:00",
        "updated_at": "2018-06-14T03:25:20+00:00",
        "closed_at": null,
        "comments_count": [],
        "labels": []
    },
    {
        "repo": "PaddlePaddle/continuous_evaluation",
        "number": 62,
        "title": "CE 框架web问题修复",
        "body": "1. commit details 和 compare页面不加cache。\r\n如果用户请求了一个commit detail页面后再请求另一个commit detail页面，因为缓存的存在，会导致用户看到的页面信息和实际对不上。 而且这个响应时间本来比较短，可以不加缓存\r\n![details](https://user-images.githubusercontent.com/32069604/40790975-e44db604-6528-11e8-9932-c0deb4cfa71c.JPG)\r\n\r\n\r\n2. compare 显示的commit id信息，目前没有顺序\r\n计划将新的commit 显示在上面，老commit在下面的顺序排列，方便选择\r\n\r\n\r\n3. 对于后来模型新加的kpis， 需要判断是否两者均有相应的kpi，否则会key error\r\n![code](https://user-images.githubusercontent.com/32069604/40791833-fed15a88-652a-11e8-8a78-fe63778433c1.JPG)\r\n\r\n\r\n比如选择两个commit 比较，ce server报错：\r\n![error](https://user-images.githubusercontent.com/32069604/40791648-953e399c-652a-11e8-9b40-f088e5f9fe0d.PNG)\r\n\r\n",
        "state": "closed",
        "user": "guochaorong",
        "closed_by": "guochaorong",
        "created_at": "2018-05-31T15:30:28+00:00",
        "updated_at": "2018-05-31T15:40:22+00:00",
        "closed_at": "2018-05-31T15:40:22+00:00",
        "comments_count": [],
        "labels": []
    },
    {
        "repo": "PaddlePaddle/continuous_evaluation",
        "number": 66,
        "title": "CE 模型重构",
        "body": "目前一个模型目录中， 所有gpu，cpu场景都配置在里面。\r\n导致其中kpi相关配置，以及model中记录kpi的变量越来越多。\r\n比如： 加一个4卡和8卡\r\n\r\n需要把kpi配置， 启动脚本等，都平铺开来。\r\n![aa](https://user-images.githubusercontent.com/32069604/41295348-f2546dde-6e8c-11e8-919c-b8c2fe175357.JPG)\r\n\r\nhttps://github.com/PaddlePaddle/paddle-ce-latest-kpis/pull/37\r\n\r\n\r\n随着我们机器型号和模型场景（Gpu单卡、多卡，cpu等）不断扩充， 维护起来比较费劲。\r\n\r\n### 计划进行如下重构：\r\n每一个模型有一个对应的base模型：\r\n```sh\r\nresnet50\r\n``` \r\n\r\nbase模型里存放的内容有：\r\nmodel.py（模型脚本）,  continuous_evaluation.py （kpi 变量）， 所有模型共用。\r\n\r\n可以在此基础上定义各种场景模型\r\n```sh\r\nresnet50-p40-card8    \r\nresnet50-p40-card4    \r\nresnet50-p40-card1\r\nresnet50-v100-card4\r\nresnet50-v100-card1\r\n```\r\n每个模型里面的内容是一个启动脚本run.xsh， 一个latest_kpis目录，里面对应的是这个场景的kpi标杆数据。\r\n\r\n### 进行的改动\r\n1. main.xsh 和 eva.xsh \r\n1.1 base 模型不跑（base模型中不含run.xsh）\r\n1.2 import kpi配置，改为from tasks.%s.continuous_evaluation import tracking_kpis' \r\n% task_name.split('-')[0]\r\n\r\n\r\n2. main.xsh需要加入模型匹配跑模型（比如在 aws agent上只跑 '-p40-'的 模型）\r\n ./main.xsh --task_pre -p40-\r\n\r\n3.  bug fix: delete 模型目录，会计入changed tasks中， 在模型入库时，pr check会失败。需要刨去delete的模型目录（如从 resnet50 改为__resnet50）",
        "state": "open",
        "user": "guochaorong",
        "closed_by": null,
        "created_at": "2018-06-12T13:55:36+00:00",
        "updated_at": "2018-06-14T02:28:25+00:00",
        "closed_at": null,
        "comments_count": [
            "guochaorong",
            "Superjomn",
            "guochaorong"
        ],
        "labels": []
    },
    {
        "repo": "PaddlePaddle/continuous_evaluation",
        "number": 61,
        "title": "CE db优化",
        "body": "",
        "state": "open",
        "user": "guochaorong",
        "closed_by": null,
        "created_at": "2018-05-31T04:23:30+00:00",
        "updated_at": "2018-05-31T04:27:50+00:00",
        "closed_at": null,
        "comments_count": [
            "guochaorong"
        ],
        "labels": []
    },
    {
        "repo": "PaddlePaddle/continuous_evaluation",
        "number": 74,
        "title": "CE 支持跑指定模型",
        "body": "debug时， 可以在teamcity上指定具体模型跑",
        "state": "open",
        "user": "guochaorong",
        "closed_by": null,
        "created_at": "2018-06-20T05:42:15+00:00",
        "updated_at": "2018-06-22T12:13:09+00:00",
        "closed_at": null,
        "comments_count": [
            "guochaorong"
        ],
        "labels": []
    },
    {
        "repo": "PaddlePaddle/continuous_evaluation",
        "number": 75,
        "title": "CE db 支持多agent连接",
        "body": "原来CE 只有一个agent ， db 在agent 本机上，直接用的127.0.0.1\r\n现在设置了多个agent，  配置文件中127.0.0.1改成环境变量。 在teamcity 上设置该环境变量",
        "state": "closed",
        "user": "guochaorong",
        "closed_by": "guochaorong",
        "created_at": "2018-06-21T02:16:51+00:00",
        "updated_at": "2018-06-22T12:12:09+00:00",
        "closed_at": "2018-06-22T12:12:09+00:00",
        "comments_count": [
            "guochaorong"
        ],
        "labels": []
    },
    {
        "repo": "PaddlePaddle/continuous_evaluation",
        "number": 91,
        "title": "TODO of CE restructure.",
        "body": "### DB:\r\n- [ ] Deploy MySQL DB, for example, XDB in baidu.\r\n- [ ] Design DB schema.\r\n- [ ] Familar with DB client API.\r\n\r\n### Monitor\r\n- [ ] Monitor tasks' status and send warning email if a commit's task fails.\r\n   - Don't send warning email repeatedly.\r\n   - New commit's success can overlap old commit's failure.\r\n\r\n### Report\r\n- [ ] Send daily (or weekly?) report to the email group\r\n  - [ ] Need a new email group to include developers, users, and leaders.\r\n  - [ ] accuracy, speed, memory usage\r\n\r\n### Web Monitor\r\n- [ ] List recent commits' tasks status order by time.\r\n- [ ] List history commits' task status by time region.\r\n\r\n### PaddleCloud\r\n- [ ] Prepare our docker image run on paddlecloud.\r\n- [ ] Prepare paddlecloud client to commit our docker image to run jobs.\r\n     - [ ] Give a task (env) interface.\r\n\r\n### Change of old CE:\r\n- [ ] Add DB support\r\n- [ ] Change shell script from sync to async and call paddlecloud client.\r\n\r\nFuture: Add more models to CE.",
        "state": "open",
        "user": "gongweibao",
        "closed_by": null,
        "created_at": "2018-07-07T03:22:34+00:00",
        "updated_at": "2018-08-06T05:50:00+00:00",
        "closed_at": null,
        "comments_count": [],
        "labels": []
    },
    {
        "repo": "PaddlePaddle/continuous_evaluation",
        "number": 92,
        "title": "CE framework refactor design",
        "body": "This version will contain the following enhancement:\r\n\r\n- more unittests for better extending and teamworking\r\n- store the KPIs to DB\r\n- more clear abstraction in Python for the data structures in DB\r\n- consistent task-specified argument setting (by environment variable)\r\n- change DB from MongoDB to Redis for simplier usage\r\n- better monitor with\r\n  - unit representation in charts\r\n- with a report for measuring the KPIs change\r\n\r\n**This refactor will still be compatible with the original kpi.py and all the tasks**.\r\n",
        "state": "open",
        "user": "Superjomn",
        "closed_by": null,
        "created_at": "2018-07-07T03:45:23+00:00",
        "updated_at": "2018-07-07T03:48:40+00:00",
        "closed_at": null,
        "comments_count": [],
        "labels": [
            "design"
        ]
    },
    {
        "repo": "PaddlePaddle/continuous_evaluation",
        "number": 76,
        "title": "CE 迁移到厂内机器 & CE 部署结构优化",
        "body": "由于aws上的CE这台机器成本太高， 计划迁移到厂内机器。 在厂内V100 和P40 上各搭建一个CE agent\r\n\r\n同时对目前CE环境的部署结构做了优化。\r\n\r\naws上  teamcity agent 部署在一个docker内，并且和teamcity web， db共用该docker。\r\n有两个问题：\r\n1. 结构不是很清晰。 \r\n2. 如果该docker 出问题， agent 和web 同时down\r\n\r\n更改后的结构：\r\n1. agent 部署在虚机上（厂内阡陌机器）\r\n2. 执行编译、模型的是一个docker 镜像\r\n3. 启动web和db的是一个docker镜像\r\n\r\n\r\n\r\n",
        "state": "closed",
        "user": "guochaorong",
        "closed_by": "kolinwei",
        "created_at": "2018-06-21T02:21:55+00:00",
        "updated_at": "2019-05-29T09:19:01+00:00",
        "closed_at": "2019-05-29T09:19:01+00:00",
        "comments_count": [],
        "labels": []
    },
    {
        "repo": "PaddlePaddle/continuous_evaluation",
        "number": 78,
        "title": "CE 迁移到厂内， 多机模型运行失败",
        "body": "\r\n![docker](https://user-images.githubusercontent.com/32069604/41719860-e34e6264-7593-11e8-9800-70c92bddfcc0.JPG)\r\n\r\n\r\nhttp://10.255.100.55:8111/viewLog.html?tab=buildLog&buildTypeId=ContinuousEvaluation_PaddleContinuousEvaluation&buildId=1\r\n\r\n\r\n请闫旭老师帮忙弄下teamcity agent 的docker中需要一些什么设置~\r\n机器：10.255.100.55\r\ndocker 容器：teamcity-agent\r\n\r\n\r\n登录方式我单给你下~\r\n谢谢",
        "state": "open",
        "user": "guochaorong",
        "closed_by": null,
        "created_at": "2018-06-21T12:47:11+00:00",
        "updated_at": "2018-06-22T05:38:00+00:00",
        "closed_at": null,
        "comments_count": [
            "Yancey0623"
        ],
        "labels": []
    },
    {
        "repo": "PaddlePaddle/continuous_evaluation",
        "number": 88,
        "title": "VGG16 模型 `flowers_32_train_speed` 指标异常",
        "body": "值班日志 https://github.com/PaddlePaddle/continuous_evaluation/wiki/Duty-Records#20180628\r\n\r\n判定为 https://github.com/PaddlePaddle/Paddle/pull/11690 引入的问题",
        "state": "closed",
        "user": "Superjomn",
        "closed_by": "Superjomn",
        "created_at": "2018-06-29T05:01:22+00:00",
        "updated_at": "2018-06-30T06:57:02+00:00",
        "closed_at": "2018-06-30T06:57:02+00:00",
        "comments_count": [
            "typhoonzero",
            "guochaorong",
            "guochaorong",
            "guochaorong",
            "typhoonzero",
            "Superjomn",
            "Superjomn"
        ],
        "labels": [
            "kpi-abnormal-case"
        ]
    },
    {
        "repo": "PaddlePaddle/continuous_evaluation",
        "number": 96,
        "title": "vgg模型的性能指标逐渐下降",
        "body": "![945c1e15aadea0447d3a8359d](https://user-images.githubusercontent.com/1426912/42889135-46eb9104-8adc-11e8-94be-d3da9da64953.png)\r\n\r\nAWS->P40->V100 迁移过程中性能逐渐下降。\r\n",
        "state": "closed",
        "user": "Yancey0623",
        "closed_by": "kolinwei",
        "created_at": "2018-07-18T14:36:42+00:00",
        "updated_at": "2019-05-29T09:18:50+00:00",
        "closed_at": "2019-05-29T09:18:50+00:00",
        "comments_count": [
            "guochaorong"
        ],
        "labels": []
    },
    {
        "repo": "PaddlePaddle/continuous_evaluation",
        "number": 94,
        "title": "debug 模式下不修改db数据",
        "body": "specific_tasks 执行task 不修改db， 不更新基数据。\r\n\r\n后面两次是调试的信息，不应该写入db\r\n![dd](https://user-images.githubusercontent.com/32069604/42720167-a62a3dfe-8754-11e8-9432-9787cd741ac0.PNG)\r\n\r\n",
        "state": "closed",
        "user": "guochaorong",
        "closed_by": "guochaorong",
        "created_at": "2018-07-14T02:57:14+00:00",
        "updated_at": "2018-08-04T02:29:46+00:00",
        "closed_at": "2018-08-04T02:29:46+00:00",
        "comments_count": [
            "guochaorong",
            "guochaorong"
        ],
        "labels": []
    },
    {
        "repo": "PaddlePaddle/continuous_evaluation",
        "number": 100,
        "title": "night build failed since the size of fluid.tgz.",
        "body": "[11:14:00][Publishing artifacts] Collecting files to publish: [output/paddlepaddle*.whl, build/paddle.tgz, build/fluid.tgz]\r\n[11:14:00][Publishing artifacts] Failed to publish artifacts: Artifact file 'fluid.tgz' has size 2654525440 bytes which exceeds maximum allowed size of 2147483648 bytes. Maximum artifact size is configured at the Administration -> Global Settings page.\r\n[11:14:00]Failed to publish artifacts: Artifact file 'fluid.tgz' has size 2654525440 bytes which exceeds maximum allowed size of 2147483648 bytes. Maximum artifact size is configured at the Administration -> Global Settings page.\r\n[11:14:00]",
        "state": "open",
        "user": "qingqing01",
        "closed_by": null,
        "created_at": "2018-07-23T11:29:40+00:00",
        "updated_at": "2018-08-06T05:47:54+00:00",
        "closed_at": null,
        "comments_count": [
            "guochaorong",
            "luotao1",
            "guochaorong"
        ],
        "labels": []
    },
    {
        "repo": "PaddlePaddle/continuous_evaluation",
        "number": 127,
        "title": "language mode 模型性能下降",
        "body": "job: http://ce.paddlepaddle.org:8080/viewLog.html?buildId=1967&buildTypeId=PaddleCe_CEBuild&tab=buildLog \r\n\r\n``` text\r\n[08:42:15]\t[Step 1/1] [imikolov_20_pass_duration] failed, diff ratio: 0.02094002761520184 larger than 0.02.\r\n[08:42:15]\t[Step 1/1] Task is disabled, [imikolov_20_avg_ppl_card4] pass\r\n[08:42:15]\t[Step 1/1] [imikolov_20_pass_duration_card4] pass\r\n[08:42:15]\t[Step 1/1] kpis keys ['imikolov_20_avg_ppl', 'imikolov_20_pass_duration', 'imikolov_20_avg_ppl_card4', 'imikolov_20_pass_duration_card4']\r\n[08:42:15]\t[Step 1/1] kpis values [[[34.16410827636719]], [[33.631132423877716]], [[78.40382385253906]], [[13.359583675861359]]]\r\n\r\n```",
        "state": "closed",
        "user": "Yancey0623",
        "closed_by": "kolinwei",
        "created_at": "2018-09-30T09:19:06+00:00",
        "updated_at": "2019-05-29T09:18:28+00:00",
        "closed_at": "2019-05-29T09:18:28+00:00",
        "comments_count": [],
        "labels": []
    },
    {
        "repo": "PaddlePaddle/continuous_evaluation",
        "number": 129,
        "title": "image classification 性能下降",
        "body": "job link: http://180.76.57.222:8111/viewLog.html?buildId=721&buildTypeId=PaddleModesl_Build&tab=buildLog\r\n\r\n",
        "state": "closed",
        "user": "Yancey0623",
        "closed_by": "kolinwei",
        "created_at": "2018-09-30T10:33:14+00:00",
        "updated_at": "2019-05-29T09:18:08+00:00",
        "closed_at": "2019-05-29T09:18:08+00:00",
        "comments_count": [],
        "labels": []
    },
    {
        "repo": "PaddlePaddle/continuous_evaluation",
        "number": 128,
        "title": "language model core dump on CE",
        "body": "job link: http://ce.paddlepaddle.org:8080/viewLog.html?buildId=1966&buildTypeId=PaddleCe_CEBuild&tab=buildLog\r\n\r\n``` text\r\n[05:28:57]W:\t [Step 1/1] *** Aborted at 1538285337 (unix time) try \"date -d @1538285337\" if you are using GNU date ***\r\n[05:28:57]W:\t [Step 1/1] PC: @                0x0 (unknown)\r\n[05:28:57]W:\t [Step 1/1] *** SIGSEGV (@0x58) received by PID 7765 (TID 0x7fc7987af700) from PID 88; stack trace: ***\r\n[05:28:57]W:\t [Step 1/1]     @     0x7fc82c5a67e0 (unknown)\r\n[05:28:57]W:\t [Step 1/1]     @     0x7fc82c8b950c PyEval_EvalFrameEx\r\n[05:28:57]W:\t [Step 1/1]     @     0x7fc82c8c237d PyEval_EvalCodeEx\r\n[05:28:57]W:\t [Step 1/1]     @     0x7fc82c839905 (unknown)\r\n[05:28:57]W:\t [Step 1/1]     @     0x7fc82c807d33 PyObject_Call\r\n[05:28:57]W:\t [Step 1/1]     @     0x7fc82c8bd0a2 PyEval_EvalFrameEx\r\n[05:28:57]W:\t [Step 1/1]     @     0x7fc82c8bfe9e PyEval_EvalFrameEx\r\n[05:28:57]W:\t [Step 1/1]     @     0x7fc82c8bfe9e PyEval_EvalFrameEx\r\n[05:28:57]W:\t [Step 1/1]     @     0x7fc82c8c237d PyEval_EvalCodeEx\r\n[05:28:57]W:\t [Step 1/1]     @     0x7fc82c839830 (unknown)\r\n[05:28:57]W:\t [Step 1/1]     @     0x7fc82c807d33 PyObject_Call\r\n[05:28:57]W:\t [Step 1/1]     @     0x7fc82c81674d (unknown)\r\n[05:28:57]W:\t [Step 1/1]     @     0x7fc82c807d33 PyObject_Call\r\n[05:28:57]W:\t [Step 1/1]     @     0x7fc82c8b8897 PyEval_CallObjectWithKeywords\r\n[05:28:57]W:\t [Step 1/1]     @     0x7fc82c904f32 (unknown)\r\n[05:28:57]W:\t [Step 1/1]     @     0x7fc82c59eaa1 start_thread\r\n[05:28:57]W:\t [Step 1/1]     @     0x7fc82bc60bcd clone\r\n[05:28:57]W:\t [Step 1/1]     @                0x0 (unknown)\r\n[05:28:58]W:\t [Step 1/1] ./run.xsh: line 14:  7765 Segmentation fault      FLAGS_benchmark=true FLAGS_fraction_of_gpu_memory_to_use=0.0 python model.py --device=GPU --batch_size=${FLOWERS_BATCH_SIZE} --data_set=flowers --iterations=100 --gpu_id=$cudaid\r\n```",
        "state": "closed",
        "user": "Yancey0623",
        "closed_by": "kolinwei",
        "created_at": "2018-09-30T09:25:18+00:00",
        "updated_at": "2019-05-29T09:18:18+00:00",
        "closed_at": "2019-05-29T09:18:18+00:00",
        "comments_count": [],
        "labels": []
    },
    {
        "repo": "PaddlePaddle/continuous_evaluation",
        "number": 109,
        "title": "CE framework  robustness enhance",
        "body": "CE 框架里面有不少特例情况未打印日志， 异常等没有捕获，， 现在部署的环境机器较多，加上厂内环境各个机器软硬件、网络等情况不一， debug问题较难，\r\n \r\n使用的 xonsh等工具，出错后错误信息不准确，容易误导\r\n\r\n对于一些高频操作，需要有较严格的机制保证成功率。\r\n\r\n希望以后CE框架不会因为修改代码调试难，或担心改坏拖着不能进code，影响正常的功能支持速度。\r\n预计以后CE 框架的迭代速度比现在有较大提升。",
        "state": "closed",
        "user": "guochaorong",
        "closed_by": "kolinwei",
        "created_at": "2018-08-04T03:47:33+00:00",
        "updated_at": "2019-05-29T09:18:38+00:00",
        "closed_at": "2019-05-29T09:18:38+00:00",
        "comments_count": [],
        "labels": []
    }
]